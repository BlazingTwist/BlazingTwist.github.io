<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="css/projects.css">
    <link rel="stylesheet" type="text/css" href="css/animatedListTest.css">
    <link rel="stylesheet" type="text/css" href="css/parallax.css">
    <script src="js/animatedList.js"></script>
    <script src="js/spaceTexParallax.js"></script>
    <meta charset="UTF-8">
    <title>Animated List Test</title>
</head>
<body>

<script>
    let insertedNodes = 0;

    function getInsertionElement() {
        let nodeToInsert = document.getElementById("generatedElementContainer").children.item(0).cloneNode(true);
        let targetElementHeight = Math.floor((50 + Math.random() * 100) * 0.5) * 2;
        nodeToInsert.style.height = "" + targetElementHeight + "px";
        insertedNodes++;
        nodeToInsert.innerHTML = nodeToInsert.innerHTML.replace("${nodeIndex}", "" + insertedNodes);

        let paragraphElement = nodeToInsert.children.item(0);
        paragraphElement.style.margin = "0";
        paragraphElement.style.transform = "translateY(calc(" + (0.5 * targetElementHeight) + "px - 50%)";

        return nodeToInsert;
    }

    function onClickAddElem() {
        let insertIndex = parseInt(document.getElementById("insert-index-input").value) + 1;
        let animatedList = document.getElementById("animatedList");
        let nodeToInsert = getInsertionElement();

        AnimatedList.insertNode(animatedList, nodeToInsert, insertIndex, AnimatedList.animateInflateInsertion.name);

        /*let queryString = window.location.search;
        window.history.replaceState(null, null, queryString + "&numElements=" + insertedNodes);*/
    }

    function onClickRemoveElem(target) {
        let animatedList = document.getElementById("animatedList");
        AnimatedList.removeNode(animatedList, target, AnimatedList.animateShiftRightRemove.name);
    }

    document.addEventListener('DOMContentLoaded', function () {
        SpaceTexParallax.registerElements("parallax-container", "animatedList-container", "space-tex-div", "treeline-div", 5);
    })
</script>

<div style="display: none; visibility: hidden;" id="generatedElementContainer">
    <div class="flex-centered" style="height: 200px; width: 200px;" onclick="onClickRemoveElem(this)">
        <p>INSERTED NODE #${nodeIndex}</p>
    </div>
</div>

<div class="parallax" id="parallax-container">
    <div id="space-tex-div">
        <picture>
            <source media="(min-width: 2560px)" srcset="img/spacetex-3072-tileY.png">
            <source media="(min-width: 1536px)" srcset="img/spacetex-2048-tileY.png">
            <img src="img/spacetex-1024-tileY.png" alt="sky texture"/>
        </picture>
    </div>
    <div id="treeline-div">
        <img src="img/treeline-stroked-tileX.png" alt="treeline"/>
        <div style="background-color: #000000;"></div>
    </div>
    <div id="animatedList-container">
        <div class="basic-flex-column" style="width: 100%;" id="animatedList">
            <div class="basic-flex-row flex-centered" style="margin: 10px 0; width: auto; padding: 5px 10px; gap: 10px">
                <label for="insert-index-input">Insertion Index</label>
                <input type="number" id="insert-index-input" value="0">
                <div class="project-entry-tag"
                     onclick="onClickAddElem(this)">
                    Add Element
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
