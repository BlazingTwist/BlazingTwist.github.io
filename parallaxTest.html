<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="css/parallax.css">
    <meta charset="UTF-8">
    <title>Parallax Test</title>
</head>
<body>

<div id="sky-tex-js-holder" style="display: none; visibility: hidden">
    <!-- beware! nasty almost-but-not-quite-duplicate of an element contained in 'space-tex-div' -->
    <picture>
        <source media="(min-width: 2560px)" srcset="img/spacetex-3072-tileY.png">
        <source media="(min-width: 1536px)" srcset="img/spacetex-2048-tileY.png">
        <img src="img/spacetex-1024-tileY.png" alt="sky texture" style="width: 100%; margin-top: -1px"/>
    </picture>
</div>

<div class="parallax">
    <script>
        function resizeBackground() {
            let mainContentDiv = document.getElementById("main-content-div");
            let windowHeight = window.innerHeight;
            let windowWidth = window.innerWidth;
            
            // space tex img properties
            let spaceTexWidth = 1024;
            let spaceTexHeight = 2887;
            
            // treeline img properties
            let treelineWidth = 3286;
            let treelineHeight = 685;
            let treelineVisibleHeight = windowWidth / treelineWidth * treelineHeight;
            
            let scrollHeight = Math.max(0, (mainContentDiv.offsetHeight + (0.2 * windowHeight)) - windowHeight)
            scrollHeight += (treelineVisibleHeight * 2);

            // compute size for spaceTex
            let spaceTexDiv = document.getElementById("space-tex-div");
            let targetSpaceTexWidth = (windowWidth * 2);
            let targetSpaceTexHeight = ((windowHeight + (scrollHeight)) * 2);

            spaceTexDiv.style.transform = "translateX(-" + (windowWidth / 2) + "px) translateY(-" + (windowHeight / 2) + "px) translateZ(-300px)";
            spaceTexDiv.style.width = "" + targetSpaceTexWidth + "px";
            spaceTexDiv.style.height = "" + targetSpaceTexHeight + "px";

            // repeat image if target height exceeds height of image
            let currentSingleImageHeight = targetSpaceTexWidth / spaceTexWidth * spaceTexHeight;
            let coveredHeight = spaceTexDiv.childElementCount * currentSingleImageHeight;
            if (coveredHeight < targetSpaceTexHeight) {
                let skyTexHolder = document.getElementById("sky-tex-js-holder");
                let skyTexImg = skyTexHolder.children.item(0);
                while (coveredHeight < targetSpaceTexHeight) {
                    spaceTexDiv.appendChild(skyTexImg.cloneNode(true));
                    coveredHeight += currentSingleImageHeight;
                }
            }

            // compute size for treeline
            // this should set the translateZ property such that the image is
            //  - fully off-screen at the top of the page (top edge of img is touching bottom edge of view)
            //  - fully on-screen at the bottom of the page (bottom edge of img is touching bottom edge of view)
            // consequently: visible y translation on page scroll == true image height
            // thus: translateZ = perspective - (perspective * scrollableHeight / trueImageHeight)
            // e.g.: translateZ = 300 - (300 * 2500 / 250) = 300 - (300 * 10) = -2700
            //  the resulting scroll slowdown will then be 10x -> 2500 px scroll translates to 250 px scroll
            let treelineScaleFactor = scrollHeight / treelineVisibleHeight;
            let treelineTranslateZ = 300 - (300 * treelineScaleFactor);
            
            let treelineDiv = document.getElementById("treeline-div");
            // currently the image left edge is ((windowWidth / 2) - ((windowWidth / 2) / treelineScaleFactor))
            //  pixels away from the left edge of the viewport (the same applies to the topEdge using windowHeight)
            // ((windowWidth / 2) - ((windowWidth / 2) / treelineScaleFactor)) * treelineScaleFactor
            // = (windowWidth / 2 * treelineScaleFactor) - (windowWidth / 2)
            // = (windowWidth / 2) * ((treelineScaleFactor) - (1))
            let treelineOffsetFactor = (treelineScaleFactor - 1) / 2;
            let treelineWidthOffset = windowWidth * treelineOffsetFactor;
            let treelineHeightOffset = windowHeight * treelineOffsetFactor;
            treelineDiv.style.transform = "translateX(-" + (treelineWidthOffset) + "px) translateY(-" + (treelineHeightOffset) + "px) translateZ(" + treelineTranslateZ + "px)";
            treelineDiv.style.width = "" + (windowWidth * treelineScaleFactor) + "px";
            treelineDiv.style.height = "" + ((windowHeight + scrollHeight) * treelineScaleFactor) + "px";
            
            let treelineImg = document.getElementById("treeline-img");
            treelineImg.style.marginTop = "" + (windowHeight * 0.9 * treelineScaleFactor) + "px";
        }

        document.addEventListener('DOMContentLoaded', function () {
            resizeBackground()
            new ResizeObserver(resizeBackground).observe(document.getElementById("main-content-div"));
        })
    </script>

    <div class="parallax_layer parallax_layer--back" style="height: 100%; width: 100%; font-size: 0;" id="space-tex-div">
        <picture>
            <source media="(min-width: 2560px)" srcset="img/spacetex-3072-tileY.png">
            <source media="(min-width: 1536px)" srcset="img/spacetex-2048-tileY.png">
            <img src="img/spacetex-1024-tileY.png" alt="sky texture" style="width: 100%;"/>
        </picture>
    </div>
    <div class="parallax_layer parallax_layer--back_overlay" style="height: 100%; width: 100%; font-size: 0;" id="treeline-div">
        <img src="img/treeline-stroked-tileX.png" alt="treeline" style="width: 100%; margin-top: 80vh;" id="treeline-img"/>
        <div style="margin-top: -1px; width: 100%; height: 100%; background-color: #000000;"></div>
    </div>
    <!--<img src="img/skytex-new-tileY.png" class="sky_background_img parallax_layer parallax_layer--back" alt="sky texture" style="top:563.8vw;"/>-->
    <div class="parallax_layer parallax_layer--base table-container"
         style="font-size: 1em; color: white; height: max-content;" id="main-content-div">
        <table class="data-table">
            <tbody>
            <tr>
                <td>&nbsp;<b>
                    Time</b>&nbsp;
                </td>
                <td>&nbsp;<b>
                    Priority</b>&nbsp;
                </td>
                <td>&nbsp;<b>
                    Description</b>&nbsp;
                </td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:49 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;Received Response to Broadcast Maintenance Request, But no Un...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Tue Aug 16 01:42:00 2022
                    &nbsp;
                </td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;SSH user logged out.&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Warning (5)&nbsp;</td>
                <td>&nbsp;DHCP WARNING - Non-critical field invalid in response ;CM-MAC...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;Honoring MDD; IP provisioning mode = IPv4&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Critical (3)&nbsp;</td>
                <td>&nbsp;No Ranging Response received - T3 time-out;CM-MAC=cc:35:40:e1...&nbsp;</td>
            </tr>
            <tr>
                <td>&nbsp;Time Not Established&nbsp;</td>
                <td>&nbsp;Notice (6)&nbsp;</td>
                <td>&nbsp;WiFi Interface [wl0] set to Channel 1 (Side-Band Channel:N/A)...&nbsp;</td>
            </tr>
            <tr>
                <td>this</td>
                <td>is the</td>
                <td>end</td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

</body>
</html>
